<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8" />

    <title>Seattle Urban Bridge Geography</title>
    
    <!-- add leaflet css stylesheet-->
    <link 
        rel="stylesheet" 
        href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" 
    />

    <style>
        /* CSS rules here */
        
        overide default leaflet tooltip css
        .tooltip {
            color: white;
            background: #295b97;
            border: 0;
            font-size: 1.3em;
        }
        
        /* Add custom map style */
        /* select both the body and the map */
        body,
        #map {
            position: absolute;
            width: 100%;
            top: 0;
            bottom: 0;
            margin: 0;
            padding: 0;
            background: rgba(0, 0, 0, 0.75);
        }
    </style>
</head>

<body>
    <!-- HTML tag to hold map -->
    <div id="map"></div>

    <!-- Add leaflet js -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

    <!-- Add jquery to laod json files -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" 
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"
    ></script>

    <script>
        // JavaScript goes here
        
        //map options
        const options = {
         center: [47.5807, -122.05239],
         zoom: 9,
         minZoom: 2,
         maxZoom: 16,
         maxBounds: [
             [47.91361, -121.17005], //north east
             [47.24571, -122.9347], //south west
            ],
        };
        
        // create Leaflet map and apply options
        const map = L.map('map', options);

        
       // OpenStreetMap option if not building own basemap
        // const tiles = 
        // L.tileLayer(

        //     'https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', 
        //     {
	    //         attribution: 
        //         '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	    //         subdomains: 'abcd',
	    //         maxZoom: 19 
        //     }
        // ).addTo(map);

        //add to base map JSON of interest 
        $.when(
            $.getJSON('data/seattle_urban.json'),
            $.getJSON('data/king_cnty_bridge_and_tunnels.json')
        ).done(function (urbanAreasData, bridgeTunnelData) {
            drawMap(urbanAreasData, bridgeTunnelData);
        });
        
        function drawMap(urbanAreasData, bridgeTunnelData) {
                   
            console.log(urbanAreasData)
            console.log(bridgeTunnelData)

            const urbanOptions = {
            color: '#295b97', //medium blue (gray)
            weight: 1,
            opacity: 1,
            };

            // const bridgeOptions = {
            // color: '#ff6e00', //orange
            // weight: 2,
            // opacity: 1,
            // };

            // const tunnelOptions = {
            // color: '#f0f062', //yellow
            // weight: 0.1,
            // opacity: 1,
            // };

            // const otherOptions = {
            // color: '#ff6e00', //orange
            // };

        //Leaflet Layer for Urban Areas    
         L.geoJson(urbanAreasData, {
            style: urbanOptions,
         }).addTo(map); 
            
        //Leaflet Layer for Bridge & Tunnel
         L.geoJson(bridgeTunnelData, {
            //style each feature
             style:function(feature) {
                //shortcut to variable
                 let type = feature.properties.rte_type;

                 //assign options
                 return type === 'subway, metro'
                 ? subwayOptions
                 : type === 'bus'
                 ? busOptions
                 : type === 'tram, light rail, streetcar'
                 ? tramOptions
                 : otherOptions;
             },
         }).addTo(map);
    }

    //leaflet    
    // map.createPane('labels');
    // map.getPane('labels').style.zIndex = 650;
    // map.getPane('labels').style.pointerEvents = 'none';

    L.tileLayer(
      'http://global.ssl.fastly.net/rastertiles/dark_only_labels/{z}/{x}/{y}.png',
      {
        attribution: '©OpenStreetMap, ©CartoDB',
        pane: 'labels',
      }
    ).addTo(map);

    </script>
  </body>
</html>